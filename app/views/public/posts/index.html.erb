<h1>投稿一覧</h1>
<h3>投稿を検索</h3>
 <%= form_tag({controller:"posts",action:"index"}, method: :get) do %>
  <%= text_field_tag :search %>
  <%= submit_tag '検索する' %>
 <% end %>
<table>
　<% @posts.each do |post| %>
　  <tr>
　    <td>
　     <% if post.image.attached? %>
       <%= image_tag post.image, size: "100x100" %>
       <% end %>
　    </td>
　    <td>
　     <%= post.title %>
　    </td> 
　    <td>
　     <%= post.body %>
　    </td>
　    <td>
　        <% if post.comments.count != 0 %>
　        <%= link_to "返信数",public_post_path(post) %>
　        <%= post.comments.count %>
　        <% end %>
　    </td>
　    <td>
　        <% if @post.favorite?(current_user) %>
           <%# 一致するレコードが存在する＝すでにいいね済みの場合はdestroyアクションへ %>
           <%= link_to post_favorite_path(@post.id), method: :delete do %>
           <span style="color:red;">❤︎</span>
          <% end %>
          <% else %>
          <%# 一致するレコードが存在しない＝まだいいねしていない場合はcreateアクションへ %>
          <%= link_to public_favorites_path(@post.id), method: :post do %>
          <span>❤︎</span>
          <% end %>
          <% end %>
　    </td>
　  </tr>
  <% end %>
</table>